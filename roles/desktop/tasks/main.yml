---
# --- SDDM Theme & Config ---
- name: Configure SDDM Theme (Sugar Candy)
  file:
    path: /etc/sddm.conf.d
    state: directory
    mode: '0755'
  tags: [desktop, sddm]

- name: Set SDDM Theme
  copy:
    content: |
      [Theme]
      Current=catppuccin-mocha
    dest: /etc/sddm.conf.d/theme.conf
  tags: [desktop, sddm]

# --- Plymouth Theme (Removed by user request) ---

# --- Firefox Profile ---
- name: Create Firefox Profile Directory
  file:
    path: "{{ ansible_user_dir }}/.mozilla/firefox/nord.default"
    state: directory
    owner: "{{ default_user }}"
    group: "{{ default_user }}"
    recurse: yes
  tags: [desktop, firefox]

# We should ideally copy the profile content here if it exists in the repo
# Since it's in the repo (assets?), we can synchronize it.
# Check if we have source profile files
# - synchronize: ...

# --- Spicetify ---
- name: Check if Spicetify is installed
  command: which spicetify
  register: spicetify_check
  ignore_errors: true
  changed_when: false
  tags: [desktop, spicetify]

- name: Set Spotify Permissions for Spicetify
  file:
    path: /opt/spotify
    mode: 'a+wr'
    recurse: yes
  when: spicetify_check.rc == 0 and ansible_facts['os_family'] == 'Archlinux' # Only if spotify is in /opt
  ignore_errors: true
  ignore_errors: true
  tags: [desktop, spicetify]

- include_tasks: assets.yml
  tags: [desktop, assets]
