---
# --- Firefox Configuration ---
- name: Ensure Firefox directory exists
  file:
    path: "{{ target_home }}/.mozilla/firefox"
    state: directory
    owner: "{{ target_user }}"
    group: "{{ target_user }}"
    mode: '0755'
  tags: [desktop, firefox]

- name: Create Firefox profiles.ini (set catppuccin as default)
  copy:
    content: |
      [Profile0]
      Name=catppuccin
      IsRelative=1
      Path=catppuccin.default
      Default=1

      [General]
      StartWithLastProfile=1
      Version=2
    dest: "{{ target_home }}/.mozilla/firefox/profiles.ini"
    owner: "{{ target_user }}"
    group: "{{ target_user }}"
    mode: '0644'
  tags: [desktop, firefox]

- name: Create Firefox profile directory
  file:
    path: "{{ target_home }}/.mozilla/firefox/catppuccin.default"
    state: directory
    owner: "{{ target_user }}"
    group: "{{ target_user }}"
    mode: '0755'
  tags: [desktop, firefox]

- name: Configure Firefox user.js (Catppuccin Mocha)
  copy:
    src: firefox_user.js
    dest: "{{ target_home }}/.mozilla/firefox/catppuccin.default/user.js"
    owner: "{{ target_user }}"
    group: "{{ target_user }}"
    mode: '0644'
  tags: [desktop, firefox]

# --- Wallpaper Setup ---
# Descomente abaixo para ativar wallpaper
- include_tasks: wallpaper.yml
  tags: [desktop, wallpaper]

# --- Other Desktop Configs ---
# GTK, QT, etc.

# Nota: Diretório files/gtk/ não existe no repositório
# Para adicionar configs GTK personalizadas, crie: roles/desktop/files/gtk/
# - name: Sync GTK Configs
#   synchronize:
#     src: "{{ role_path }}/files/gtk/"
#     dest: "{{ target_home }}/.config/gtk-3.0/"
#   become: no
#   ignore_errors: yes
#   tags: [desktop, gtk]

- name: Ensure Kvantum directory exists
  file:
    path: "{{ target_home }}/.config/Kvantum"
    state: directory
    owner: "{{ target_user }}"
    group: "{{ target_user }}"
    mode: '0755'
  tags: [desktop, kvantum]

- name: Apply GTK Theme (Catppuccin Mocha)
  command: gsettings set org.gnome.desktop.interface gtk-theme 'Catppuccin-Mocha-Standard-Blue-Dark'
  become: no
  tags: [desktop, theme, apply]

- name: Apply Icon Theme (Papirus)
  command: gsettings set org.gnome.desktop.interface icon-theme 'Papirus-Dark'
  become: no
  tags: [desktop, theme, apply]

- name: Apply Cursor Theme (Catppuccin Mocha)
  command: gsettings set org.gnome.desktop.interface cursor-theme 'Catppuccin-Mocha-Dark-Cursors'
  become: no
  tags: [desktop, theme, apply]
